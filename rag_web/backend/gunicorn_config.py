"""
Конфигурация Gunicorn для запуска Django на Beget.
"""

# Адрес и порт для привязки
bind = "127.0.0.1:8000"

# Количество воркеров
# Рекомендуется: (2 x CPU cores) + 1
workers = 3

# Класс воркера
worker_class = "sync"

# Таймауты
timeout = 300  # Время ожидания ответа (важно для долгих запросов RAG) - увеличено до 5 минут
keepalive = 5
graceful_timeout = 30  # Время для graceful shutdown

# Логирование
accesslog = "-"  # stdout
errorlog = "-"   # stderr
loglevel = "info"

# Перезапуск воркеров при изменении кода (для разработки)
# reload = True  # Раскомментируйте для авто-перезагрузки

# Предзагрузка приложения для ускорения
preload_app = True

# Максимальное количество запросов на воркер перед перезапуском (для предотвращения утечек памяти)
max_requests = 1000
max_requests_jitter = 50

